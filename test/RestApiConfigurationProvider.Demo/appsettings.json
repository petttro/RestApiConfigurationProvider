{
    "nlog": {
        "internalLogLevel": "Warn",
        "internalLogFile": "/tmp/internal-nlog.txt",
        "throwConfigExceptions": true,
        "extensions": [
            {
                "assembly": "NLog.Web.AspNetCore"
            },
            {
                "assembly": "Package.Demo"
            }
        ],
        "variables": {
            "correlationLayout": "${when:when=length('${aspnet-TraceIdentifier}')==0:inner=Id=SYSTEM:else=${when:when=length('${aspnet-TraceIdentifier}')==32:inner=Id=${aspnet-TraceIdentifier}:else=InvalidId=${aspnet-TraceIdentifier}}}",
            "messageLayout": "${replace-newlines:${replace-returns:${redact:inner=${message:withException=true}}}",
            "splunkApmLayout": "TraceId=${mdlc:item=trace_id:whenEmpty=SYSTEM}, SpanId=${mdlc:item=span_id:whenEmpty=SYSTEM}"
        },
        "targets": {
            "console": {
                "type": "ColoredConsole",
                "layout": "${longdate}|${category:CompressedName=true}|${uppercase:${level}}|${correlationLayout}|${splunkApmLayout}|${messageLayout}"
            },
            "ignore": {
                "type": "Null",
                "name": "blackhole"
            },
            "file": {
                "name": "splunkfileAsync",
                "type": "AsyncWrapper",
                "queueLimit": 20000,
                "overflowAction": "Discard",
                "target": {
                    "wrappedFile": {
                        "type": "File",
                        "name": "file",
                        "fileName": "/var/log/racp/racp-${date:format=yyyyMMddHHmm}.log",
                        "layout": "${truncate:inner=[${date:universalTime=true:format=O}] Level=${level}, Category=${category}, ${correlationLayout}, ${splunkApmLayout}, ${messageLayout}}",
                        "archiveAboveSize": 100000000,
                        "archiveEvery": "Day",
                        "archiveDateFormat": "yyyyMMdd",
                        "archiveFileName": "/var/log/racp/racp-{#}.log",
                        "archiveNumbering": "DateAndSequence"
                    }
                }
            }
        },
        "rules": [
            {
                "logger": "Microsoft.*",
                "minLevel": "Trace",
                "writeTo": "ignore",
                "final": true
            },
            {
                "logger": "*",
                "minLevel": "Trace",
                "writeTo": "file,ignore,console"
            }
        ]
    }
}
